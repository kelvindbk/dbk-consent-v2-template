___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "DBK Cookie Plugin Consent Mode V2",
  "categories": ["UTILITY"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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h2kABAAAAAEAAABaAAAAAAAAAJAAAAABAAAAkAAAAAEAA5KGAAcAAAASAAAAhKACAAQAAAABAAAA6qADAAQAAAABAAAAfAAAAABBU0NJSQAAAFNjcmVlbnNob3SKxE4XAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC12lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+MjM0PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6VXNlckNvbW1lbnQ+U2NyZWVuc2hvdDwvZXhpZjpVc2VyQ29tbWVudD4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjEyNDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjE0NDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+MTQ0PC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KRIDmhAAAEH9JREFUeAHtXQlsFdUa/rtRpIhU4IFLhIq1ClJCcAGxLghSbInRsIRiRFBBCaDIGouiICCL5lkMWpfEYqJofcqmAZ4YFQUDCvogSlgVEVxACoiyFHj9xjfv3d60992Z/9w5c879/+Rm7p2Z/z//+c757pw5y39SztQIiQgCgkCoEUgNtXfinCAgCDgICFGlIggCBiAgRDWgkMRFQUCIKnVAEDAAASGqAYUkLgoCQlSpA4KAAQgIUQ0oJHFREBCiSh0QBAxAQIhqQCGJi4KAEFXqgCBgAAJCVAMKSVwUBISoUgcEAQMQEKIaUEjioiAgRJU6IAgYgIAQ1YBCEhcFASGq1AFBwAAEhKgGFJK4KAikCwSCgCDwFwJnqnbTscpBdObEUSWQpGbnUMOSf6ixpcSKGBEEDEfgzPHDdGzJCGUkVQ2HNH1VIyr2zEPg1Ak6vmw0nTmyN7S+C1FDWzTiWFAIHP9nKZ3+6V9BJecrHSGqL9hEyRYETq4rp1M7VoU+O0LU0BeROJgoBEDQk+vLE2VeqV0hqlI4xZgpCKCpiyavKSJENaWkxE9lCKDTCJ1HVNOJZIrIOKopJSV+KkPg9E+bKD1/INte9ZalgfUUC1HZxSUGTEMgLbcXpSlw+vTeDXQqoCEdafoqKDAxIQgkGgHfT9Thw4cn2jdKTU2lzMxMatCggXPEd/eDc7m5uXTFFVdQy5YtE+5LPAkEgYnrR1paGmVlZVHjxo2dI75fdNFFdMkllzgfXA9aXnzxRfryyy99J9u5c2caNmyYb/1Yip999hktWLAg1i1xXysvD76n2DdROQUSNyJx3njhhRdSx44d6bLLLnM+eXl51KhRozi11d4WFlxycnLoyiuvpBtvvNE5BkVcTv5B1ETI1q1bacqUKVRVVcUy36pVK3r33XdZNvwq+yaq3wQTobdnzx7C57333nPMN2vWjIqLi6moqIguvvjiRCQZepu7du0ifCorKyk7O5u6detGN998MxUUFITed5UOgpwqSAqf5s+fTxkZGSrdi9uWle+oBw4coIqKCiopKaFp06bRxo0b4wbExhsPHjxIy5YtozFjxjif1atX25jNOvMEkm7btq3Oa15Ozps3z3m18KKj8l4rieoCVF1dTYsXL6b77ruPxo0bR+vXr3cvJe0RJAVhJ06cSMeOHbMahyeffJLwbsqVSZMmUdeuXblmWPpWEzUSmY8++ogeeOABKisrizydtN9XrVpFDz/8MKH1YaOgw2fRokXsrN11113Ut29fth2ugaQhqgsUev4GDhxI+/btc08l7XHdunXO03X37t1WYfDOO+/QSy+9xM4T3ulHj66ZwRQCSTqiAnO8s/Tp04feeuutEBSBXhe++eYbeuqpp/Q6oTD1Tz/9lGbMmMG2iBGEmTNnsu2oMpCURHXBmz17Nm3atMn9mbRHPFlff/114/O/Y8cOp4eXm5Gzzz6b5s6d64zjc2ylNG3NUa+lm9REBRJDhgyh33//vRYoyfjj1VdfJZObwOgYKy0tpUOHDrGL79lnnyWMmXIkPa+YMgtnc0zU0k16ogINFU2lWqga+OO3336jhQsXGuj5Xy6PHz+etm/fzvYfrwH5+fkMOymU0WUkNegxlShV3TQFIWpNkaxcuZLwREl2Qc+4iYKx8rVr17JdHzVqFPXo0cO/nbSaqa6951BG56H+bdSjqY7y9SRQ3+l4poudPn2a/vjjD+fz559//vd7fTY555977jlnjux1113HMcPSjQeT6ASAz7fffht92tfvX375hT744ANeZfWVsn+lF154wRkr92/hL8077riDBg8e7NtMSqNmlFlcRqktLvdtI5aiNqJi8rWfionMYKaR+1HxT+oChNk7uonqZ1I65tfOmjWLdu7c6WbF99EkomKc9OWXX/adV1fxmmuuoUceecT96fmY2iyXMvvMo5Ssv3nWjVfByKZvp06daOjQoYRpXZx/wWiQUEm//vrr6NOh/40/PAw1XX45/98cGJggmGWGmUdcwYKOxx9/3LeZtDYF1LBvRUJJCueMJGokqnivWLp0aeQp1nc8VU2V1157zWm+c/3fv38/10RC9ffu3UsTJkxgp4FllNOnT6cWLVr4spXeoR9lFv2dKL2hL30vSsYTFZk977zzlE1eAFGx6sRUKSwsZLv+66+/sm0k0gDmKh85coSdBF4X2rdv79tOWtseNbopvvW9KFpBVGQYy9keffRRL3mv896TJ086K03qvGjAyV69erG9DPMTdeTIkYSJDVzBcM5NN93ENROYvjVEBWK33XYbXXvttWzw8FRFb6qJgtYFV8L6RJ06dSp9/vnn3Ow5/RoDBgxg2wnSgFVEBXCYw8sVrChRNeTB9UWHfhifqK+88gotWbKEDQdaHOjXME2sI2rPnj2dsCzcgkhmol5wwQVc+JTqL1++nJ5//nm2TcTXwrpkE8U6oqIQ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"
  },
  "description": "DBK Cookie Plugin Consent Mode V2",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "PARAM_TABLE",
    "name": "defaultSettings",
    "displayName": "Default settings",
    "paramTableColumns": [
      {
        "param": {
          "type": "TEXT",
          "name": "region",
          "displayName": "Region",
          "simpleValueType": true
        },
        "isUnique": true
      },
      {
        "param": {
          "type": "TEXT",
          "name": "granted",
          "displayName": "Granted Consent Types (comma separated)",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "denied",
          "displayName": "Denied Consent Types (comma separated)",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "url_passthrough",
          "displayName": "Pass through URL parameters",
          "simpleValueType": true
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "CHECKBOX",
          "name": "ads_data_redaction",
          "checkboxText": "Redact Ads Data",
          "simpleValueType": true
        },
        "isUnique": false
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// The first two lines are optional, use if you want to enable logging
const log = require('logToConsole');
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const getCookieValues = require('getCookieValues');
const callInWindow = require('callInWindow');
const gtagSet = require('gtagSet');
const COOKIE_NAME = 'dbk_tagging_consent';
const JSON = require('JSON');
/*
 *   Splits the input string using comma as a delimiter, returning an array of
 *   strings
 */
const splitInput = (input) => {
  return input.split(',')
      .map(entry => entry.trim())
      .filter(entry => entry.length !== 0);
};
/*
 *   Processes a row of input from the default settings table, returning an object
 *   which can be passed as an argument to setDefaultConsentState
 */
const parseCommandData = (settings) => {
  const regions = splitInput(settings['region']);
  const granted = splitInput(settings['granted']);
  const denied = splitInput(settings['denied']);
  const commandData = {};
  if (regions.length > 0) {
    commandData.region = regions;
  }
  granted.forEach(entry => {
    commandData[entry] = 'granted';
  });
  denied.forEach(entry => {
    commandData[entry] = 'denied';
  });
  return commandData;
};
/*
 *   Called when consent changes. Assumes that consent object contains keys which
 *   directly correspond to Google consent types.
 */
const onUserConsent = (consent) => {
  const consentModeStates = {
    ad_storage: consent.ad_storage,
    ad_user_data: consent.ad_user_data,
    ad_personalization: consent.ad_personalization,
    analytics_storage: consent.analytics_storage,
    functionality_storage: consent.functionality_storage,
    personalization_storage: consent.personalization_storage,
    security_storage: consent.security_storage,
  };

  updateConsentState(consentModeStates);
};
/*
 *   Executes the default command, sets the developer ID, and sets up the consent
 *   update callback
 */
const main = (data) => {
  /*
   * Optional settings using gtagSet
   */
  gtagSet('ads_data_redaction', data.ads_data_redaction);
  gtagSet('url_passthrough', data.url_passthrough);
  
  // Check if cookie is set and has values that correspond to Google consent
  // types. If it does, run onUserConsent().
  const settings = getCookieValues(COOKIE_NAME);
  if (settings.length) {
    onUserConsent(JSON.parse(settings));
  } else {   
    data.defaultSettings.forEach(settings => {
        const defaultData = parseCommandData(settings);
        defaultData.wait_for_update = 500;
        setDefaultConsentState(defaultData);
    });
  }
  /**
   *   Add event listener to trigger update when consent changes
   *
   *   References an external method on the window object which accepts a
   *   function as an argument. If you do not have such a method, you will need
   *   to create one before continuing. This method should add the function
   *   that is passed as an argument as a callback for an event emitted when
   *   the user updates their consent. The callback should be called with an
   *   object containing fields that correspond to the five built-in Google
   *   consent types.
   */
  callInWindow('DBKconsentListener', onUserConsent);
};
main(data);
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "DBKconsentListener"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "ads_data_redaction"
              },
              {
                "type": 1,
                "string": "url_passthrough"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "dbk_tagging_consent"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ads_data_redaction"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 05/03/2024, 10:43:47


